type Activity {
  analysisId: Int
  archiveContentType: String
  archiveFilename: String
  archiveId: String
  archiveSize: Int
  createdAt: ISO8601DateTime!
  deletedAt: ISO8601DateTime
  evidenceText: String
  id: ID!
  justify: String
  portalUser: PortalUser
  status: String
  title: String
  updatedAt: ISO8601DateTime!
}

type Analysis {
  activities: [Activity!]
  allocatedAnalyst: [AnalystAllocations!]
  apiCode: String
  apiResponseReview: String
  assets: [Asset!]
  auditing: String
  closeComments: Boolean
  companyId: Int!
  connectivity: String
  continuousDelivery: Boolean
  contractedHours: Int
  createdAt: ISO8601DateTime
  deploySendFrequency: Int
  description: String
  dueDate: ISO8601DateTime
  endDate: ISO8601DateTime
  environmentInvaded: Boolean
  estimatedDays: String
  estimatedHours: String
  executiveSummary: String
  freeRetest: Boolean
  hasOpenRetest: Boolean
  hoursOrDays: String
  id: ID!
  integrationDeploy: Boolean
  inviteToken: String
  isOpen: Boolean!
  isPublic: Boolean
  label: String!
  language: String
  mainRecommendations: String
  microserviceFolder: String
  notificationList: String
  notifications: [Notification!]
  pid: String
  plannedStartedAt: ISO8601DateTime
  playbooks: [Playbook!]
  receiveDeploys: Boolean
  repositoryUrl: String
  retestedAt: ISO8601DateTime
  sacCode: String
  sacProjectId: Int
  secretId: String
  sshPublicKey: String
  startDate: ISO8601DateTime!
  status: String
  students: Int
  subScopeId: Int
  totalAnalysisLines: Int
  totalChangedLines: Int
  totalNewLines: Int
  totalPublishedVulnerabilities: Int
  totalRemovedLines: Int
  updatedAt: ISO8601DateTime
  userWithAccess: [PortalUser!]
  userableId: Int
  userableType: String
  vulnerabilities: [Vulnerability!]
  waiting: Boolean!
}

type AnalysisCollection {
  collection: [Analysis!]!
  metadata: CollectionMetadata!
}

type AnalystAllocations {
  allocatedHours: Int
  createdAt: ISO8601DateTime!
  id: ID!
  portalUser: PortalUser
  updatedAt: ISO8601DateTime!
}

type Asset {
  analyses: [Analysis!]
  architectureType: String
  assetType: String
  assetsTagList: String
  audience: String
  companyId: Int
  createdAt: ISO8601DateTime!
  criticity: String
  dataClassification: String
  description: String
  developmentModel: String
  developmentTeam: String
  environment: String
  id: ID!
  lifeCycle: String
  name: String
  scanType: String
  updatedAt: ISO8601DateTime!
  url: String
}

type AssetCollection {
  collection: [Asset!]!
  metadata: CollectionMetadata!
}

type CollectionMetadata {
  currentPage: Int!
  limitValue: Int!
  totalCount: Int!
  totalPages: Int!
}

"""
Autogenerated input type of CreateCredential
"""
input CreateCredentialInput {
  companyId: Int!
  description: String
  environment: String!
  name: String!
  profile: String!
  password: String!
  user: String!

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
}

"""
Autogenerated return type of CreateCredential
"""
type CreateCredentialPayload {
  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
  credential: Credential
  errors: [String!]
}

"""
Autogenerated input type of CreateNotification
"""
input CreateNotificationInput {
  analysisId: Int!
  vulnerabilityTemplateId: Int!
  description: String!
  evidenceArchives: [Upload!]!

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
}

"""
Autogenerated return type of CreateNotification
"""
type CreateNotificationPayload {
  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
  errors: [String!]
  notification: Notification
}

"""
Autogenerated input type of CreateWebVulnerability
"""
input CreateWebVulnerabilityInput {
  analysisId: Int!
  vulnerabilityTemplateId: Int!

  """
  Possible options [low, medium or high]
  """
  impact: String!

  """
  Possible options [low, medium or high]
  """
  probability: String!
  description: String!
  impactResume: String!
  webProtocol: String!

  """
  Possible options [GET, POST, DELETE, PUT, PATCH, HEAD, CONNECT, OPTIONS, TRACE]
  """
  webMethod: String!
  webParameters: String!
  webUrl: String!
  webSteps: String!
  webRequest: String!
  webResponse: String!
  invaded: Boolean!

  """
  Required only if invaded true
  """
  invadedEnvironmentDescription: String
  evidenceArchives: [Upload!]!

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
}

"""
Autogenerated return type of CreateWebVulnerability
"""
type CreateWebVulnerabilityPayload {
  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
  errors: [String!]
  vulnerability: Vulnerability
}

type Credential {
  createdAt: ISO8601DateTime!
  description: String
  environment: String
  id: ID!
  name: String
  password: String
  profile: String
  updatedAt: ISO8601DateTime!
  user: String
}

type CredentialCollection {
  collection: [Credential!]!
  metadata: CollectionMetadata!
}

type Deploy {
  analysesId: Int
  createdAt: ISO8601DateTime!
  currentCommit: String
  currentTag: String
  deployUrlCompare: String
  discardReason: String
  discardedId: Int
  gauntletDiffUrl: String
  gauntletScanId: Int
  gauntletSourceCodeId: Int
  id: ID!
  previousCommit: String
  previousTag: String
  reviewed: Boolean
  reviewedAt: ISO8601DateTime
  reviewer: PortalUser
  status: String
  updatedAt: ISO8601DateTime!
}

type DeployCollection {
  collection: [Deploy!]!
  metadata: CollectionMetadata!
}

"""
An ISO 8601-encoded date
"""
scalar ISO8601Date

"""
An ISO 8601-encoded datetime
"""
scalar ISO8601DateTime

type Mutation {
  """
  Create a Credential
  """
  createCredential(
    """
    Parameters for CreateCredential
    """
    input: CreateCredentialInput!
  ): CreateCredentialPayload

  """
  Create a Notification
  """
  createNotification(
    """
    Parameters for CreateNotification
    """
    input: CreateNotificationInput!
  ): CreateNotificationPayload

  """
  Create a Web Vulnerability
  """
  createWebVulnerability(
    """
    Parameters for CreateWebVulnerability
    """
    input: CreateWebVulnerabilityInput!
  ): CreateWebVulnerabilityPayload

  """
  Update activity status to finish
  """
  updateActivityStatusToFinish(
    """
    Parameters for UpdateActivityStatusToFinish
    """
    input: UpdateActivityStatusToFinishInput!
  ): UpdateActivityStatusToFinishPayload

  """
  Update activity status to not apply
  """
  updateActivityStatusToNotApply(
    """
    Parameters for UpdateActivityStatusToNotApply
    """
    input: UpdateActivityStatusToNotApplyInput!
  ): UpdateActivityStatusToNotApplyPayload

  """
  Update activity status to restart
  """
  updateActivityStatusToRestart(
    """
    Parameters for UpdateActivityStatusToRestart
    """
    input: UpdateActivityStatusToRestartInput!
  ): UpdateActivityStatusToRestartPayload

  """
  Update activity status to start
  """
  updateActivityStatusToStart(
    """
    Parameters for UpdateActivityStatusToStart
    """
    input: UpdateActivityStatusToStartInput!
  ): UpdateActivityStatusToStartPayload
}

type Notification {
  analysesId: Int
  author: PortalUser
  createdAt: ISO8601DateTime!
  description: String
  id: ID!
  notificationStatus: String
  updatedAt: ISO8601DateTime!
  vulnerabilityTemplate: VulnerabilityTemplate!
}

type NotificationCollection {
  collection: [Notification!]!
  metadata: CollectionMetadata!
}

type Playbook {
  checklistTypeId: Int
  companyId: Int
  createdAt: ISO8601DateTime
  deletedAt: ISO8601DateTime
  description: String
  id: ID!
  label: String!
  updatedAt: ISO8601DateTime
}

type PortalUser {
  allocatedAnalyses: [Analysis!]
  analyst: Boolean
  blocked: Boolean
  dashboardOnly: Boolean
  email: String!
  endWorkTime: String
  financial: Boolean
  githubUser: String
  id: ID!
  jiraUser: String
  name: String
  oper: Boolean
  phone: String
  reviewedDeploys(
    initialDate: ISO8601DateTime!
    finishDate: ISO8601DateTime!
  ): [Deploy!]
  slackUser: String
  sshPublicKey: String
  submittedVulnerabilities: [Vulnerability!]
}

type Project {
  analyses: [Analysis!]
  beginDate: ISO8601Date
  companyId: Int
  conclusion: String
  contractId: Int
  createdAt: ISO8601DateTime!
  endDate: ISO8601Date
  id: ID!
  kickoff: Boolean
  name: String
  presential: Boolean
  projectDescription: String
  projectStatus: String
  sumTotalAnalysisLines: Int
  sumTotalChangedLines: Int
  sumTotalNewLines: Int
  sumTotalRemovedLines: Int
  updatedAt: ISO8601DateTime!
}

type Query {
  """
  Returns all analyses that the analyst is allocated
  """
  allocatedAnalyses(page: Int, limit: Int): AnalysisCollection!

  """
  Returns all analyses the user has access
  """
  analyses(page: Int, limit: Int): AnalysisCollection!

  """
  Return the analysis if the user has access
  """
  analysis(id: ID!): Analysis

  """
  Returns all assets the user has access
  """
  assetsByCompanyId(id: ID!, page: Int, limit: Int): AssetCollection!

  """
  Returns all credentials by company id
  """
  credentialsByCompanyId(id: ID!, page: Int, limit: Int): CredentialCollection!

  """
  Returns deploys by analysis id
  """
  deploysByAnalysisId(
    id: ID!
    initialDate: ISO8601DateTime!
    finishDate: ISO8601DateTime!
    page: Int
    limit: Int
  ): DeployCollection!

  """
  Returns deploys by company id
  """
  deploysByCompanyId(
    id: ID!
    initialDate: ISO8601DateTime!
    finishDate: ISO8601DateTime!
    page: Int
    limit: Int
  ): DeployCollection!

  """
  Returns deploys by project id
  """
  deploysByProjectId(
    id: ID!
    initialDate: ISO8601DateTime!
    finishDate: ISO8601DateTime!
    page: Int
    limit: Int
  ): DeployCollection!

  """
  Returns all notifications the user has access
  """
  notifications(page: Int, limit: Int): NotificationCollection

  """
  Return user profile by email
  """
  portalUserProfile(email: String!): PortalUser

  """
  Return the project if the user has access
  """
  project(id: ID!): Project

  """
  Returns all vulnerabilities the user has access
  """
  vulnerabilities(page: Int, limit: Int): VulnerabilityCollection

  """
  Returns all vulnerabilities templates by company id
  """
  vulnerabilitiesTemplatesByCompanyId(
    id: ID!
    page: Int
    limit: Int
  ): VulnerabilityTemplateCollection!

  """
  Return the vulnerability if the user has access
  """
  vulnerability(id: ID!): Vulnerability

  """
  Returns all web vulnerabilities the user has access
  """
  webVulnerabilities(page: Int, limit: Int): VulnerabilityCollection
}

"""
Autogenerated input type of UpdateActivityStatusToFinish
"""
input UpdateActivityStatusToFinishInput {
  activityId: Int!
  evidence: String
  evidenceArchive: Upload

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
}

"""
Autogenerated return type of UpdateActivityStatusToFinish
"""
type UpdateActivityStatusToFinishPayload {
  activity: Activity

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
  errors: [String!]
}

"""
Autogenerated input type of UpdateActivityStatusToNotApply
"""
input UpdateActivityStatusToNotApplyInput {
  activityId: Int!
  justify: String

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
}

"""
Autogenerated return type of UpdateActivityStatusToNotApply
"""
type UpdateActivityStatusToNotApplyPayload {
  activity: Activity

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
  errors: [String!]
}

"""
Autogenerated input type of UpdateActivityStatusToRestart
"""
input UpdateActivityStatusToRestartInput {
  activityId: Int!

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
}

"""
Autogenerated return type of UpdateActivityStatusToRestart
"""
type UpdateActivityStatusToRestartPayload {
  activity: Activity

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
  errors: [String!]
}

"""
Autogenerated input type of UpdateActivityStatusToStart
"""
input UpdateActivityStatusToStartInput {
  activityId: Int!

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
}

"""
Autogenerated return type of UpdateActivityStatusToStart
"""
type UpdateActivityStatusToStartPayload {
  activity: Activity

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
  errors: [String!]
}

scalar Upload

type Vulnerability {
  affectedComponentId: Int
  analysesId: Int
  author: PortalUser
  codeReviewCode: String
  codeReviewInputData: String
  codeReviewOutputData: String
  codeReviewVector: String
  commitmentAt: ISO8601DateTime
  createdAt: ISO8601DateTime!
  criticity: String
  deployId: Int
  description: String
  externalVid: String
  failureType: String
  id: ID!
  impact: String
  impactResume: String
  invaded: Boolean
  invadedEnvironmentDescription: String
  legacyId: String
  othersHost: String
  othersProtocol: String
  othersSteps: String
  othersVector: String
  probability: String
  title: String
  updatedAt: ISO8601DateTime!
  vid: String
  vulnerabilityStatus: String
  vulnerabilityTemplate: VulnerabilityTemplate!
  webMethod: String
  webParameters: String
  webProtocol: String
  webRequest: String
  webResponse: String
  webSteps: String
  webUrl: String
}

type VulnerabilityCollection {
  collection: [Vulnerability!]!
  metadata: CollectionMetadata!
}

type VulnerabilityTemplate {
  categoryList: String
  companyId: Int
  createdAt: ISO8601DateTime!
  criticity: String
  deletedAt: ISO8601DateTime
  description: String
  id: ID!
  impact: String
  impactResume: String
  notification: Boolean
  oldId: Int
  patternList: String
  probability: String
  reference: String
  solution: String
  title: String
  updatedAt: ISO8601DateTime!
}

type VulnerabilityTemplateCollection {
  collection: [VulnerabilityTemplate!]!
  metadata: CollectionMetadata!
}
